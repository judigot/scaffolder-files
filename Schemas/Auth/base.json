{
  "$schema": "../../schema-definition.json",
  "name": "auth-base",
  "description": "Core authentication tables: user and session",
  "version": "1.0.0",
  "tables": {
    "user": {
      "description": "Core user account",
      "columns": {
        "id": {
          "type": "uuid",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        "email": {
          "type": "varchar",
          "length": 255,
          "unique": true,
          "nullable": false
        },
        "username": {
          "type": "varchar",
          "length": 50,
          "unique": true,
          "nullable": true
        },
        "passwordHash": {
          "type": "varchar",
          "length": 255,
          "nullable": true,
          "description": "Nullable for OAuth-only users"
        },
        "emailVerified": {
          "type": "boolean",
          "default": false
        },
        "createdAt": {
          "type": "timestamp",
          "default": "now()",
          "nullable": false
        },
        "updatedAt": {
          "type": "timestamp",
          "default": "now()",
          "nullable": false
        }
      },
      "indexes": [
        { "columns": ["email"], "unique": true },
        { "columns": ["username"], "unique": true }
      ]
    },
    "session": {
      "description": "User sessions for authentication",
      "columns": {
        "id": {
          "type": "varchar",
          "length": 255,
          "primary": true
        },
        "userId": {
          "type": "uuid",
          "nullable": false,
          "references": {
            "table": "user",
            "column": "id",
            "onDelete": "CASCADE"
          }
        },
        "expiresAt": {
          "type": "timestamp",
          "nullable": false
        }
      },
      "indexes": [{ "columns": ["userId"] }, { "columns": ["expiresAt"] }]
    }
  }
}
