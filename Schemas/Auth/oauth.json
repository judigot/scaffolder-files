{
  "$schema": "../../schema-definition.json",
  "name": "auth-oauth",
  "description": "OAuth provider accounts (Google, GitHub, etc.)",
  "version": "1.0.0",
  "requires": ["auth-base"],
  "tables": {
    "oauthAccount": {
      "description": "Linked OAuth provider accounts",
      "columns": {
        "id": {
          "type": "uuid",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        "userId": {
          "type": "uuid",
          "nullable": false,
          "references": {
            "table": "user",
            "column": "id",
            "onDelete": "CASCADE"
          }
        },
        "provider": {
          "type": "varchar",
          "length": 50,
          "nullable": false,
          "description": "OAuth provider name (google, github, discord, etc.)"
        },
        "providerAccountId": {
          "type": "varchar",
          "length": 255,
          "nullable": false,
          "description": "User ID from the OAuth provider"
        },
        "accessToken": {
          "type": "text",
          "nullable": true
        },
        "refreshToken": {
          "type": "text",
          "nullable": true
        },
        "tokenExpiresAt": {
          "type": "timestamp",
          "nullable": true
        },
        "createdAt": {
          "type": "timestamp",
          "default": "now()",
          "nullable": false
        }
      },
      "indexes": [
        { "columns": ["userId"] },
        { "columns": ["provider", "providerAccountId"], "unique": true }
      ]
    }
  }
}
